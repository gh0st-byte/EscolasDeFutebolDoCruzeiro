# OWASP CRS Exclusões Específicas para Escolas do Cruzeiro
# Arquivo de exclusões para evitar falsos positivos

# Exclusões para área administrativa
SecRule REQUEST_URI "@beginsWith /Backend/admin/" \
    "id:'1001',phase:1,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:password"

# Exclusões para API de dados
SecRule REQUEST_URI "@beginsWith /Backend/api/" \
    "id:'1002',phase:1,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:data"

# Exclusões para upload de arquivos JSON
SecRule REQUEST_URI "@endsWith .json" \
    "id:'1003',phase:1,pass,nolog,ctl:ruleRemoveTargetById=200002"

# Exclusões para campos específicos do sistema
# Permitir caracteres especiais em endereços
SecRule ARGS:endereco "@unconditionalMatch" \
    "id:'1010',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:endereco"

SecRule ARGS:endereco_encontrado "@unconditionalMatch" \
    "id:'1011',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:endereco_encontrado"

# Permitir URLs do WhatsApp e Instagram
SecRule ARGS:whatsapp "@unconditionalMatch" \
    "id:'1012',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:whatsapp"

SecRule ARGS:instagram_url "@unconditionalMatch" \
    "id:'1013',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:instagram_url"

# Exclusões para coordenadas geográficas
SecRule ARGS:lat "@unconditionalMatch" \
    "id:'1014',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:lat"

SecRule ARGS:lng "@unconditionalMatch" \
    "id:'1015',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:lng"

# Exclusões para conteúdo de notícias
SecRule ARGS:content "@unconditionalMatch" \
    "id:'1020',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:content"

SecRule ARGS:title "@unconditionalMatch" \
    "id:'1021',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:title"

# Exclusões para sessões PHP
SecRule REQUEST_COOKIES:PHPSESSID "@unconditionalMatch" \
    "id:'1030',phase:1,pass,nolog,ctl:ruleRemoveTargetById=920230;REQUEST_COOKIES:PHPSESSID"

# Exclusões para tokens CSRF
SecRule ARGS:csrf_token "@unconditionalMatch" \
    "id:'1031',phase:2,pass,nolog,ctl:ruleRemoveTargetById=920230;ARGS:csrf_token"